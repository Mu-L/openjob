import{_ as Q}from"./preload-helper.101896b7.js";import{u as W}from"./vue-i18n.cjs.2a00fe88.js";import"./request.554ad02f.js";import{a as z}from"./formatTime.b2c6dda0.js";import{a as X}from"./data.fead2f89.js";import{u as Y}from"./index.6b601b7a.js";import{J as ee}from"./index.f64fca3a.js";import{ay as ae}from"./index.e8f4f9cf.js";import{h as R,r as C,ap as te,K as v,o as le,a9 as n,ac as oe,j as S,k as se,l as B,D as a,x as l,u as m,B as f,C as g,y as ne,v as re}from"./vue.bd0669ce.js";import{_ as me}from"./_plugin-vue_export-helper.c27b6911.js";import"./_commonjsHelpers.35101cd5.js";import"./storage.b628b270.js";import"./index.23ad033a.js";import"./index.aa7cec2e.js";import"./themeConfig.cb88f033.js";import"./index.f9fbbdc9.js";import"./header.9390c1c5.js";import"./index.ee56f1f7.js";const ie={class:"system-role-container layout-padding"},pe={class:"system-role-padding layout-padding-auto layout-padding-view"},de={class:"system-user-search mb15"},ce=R({name:"systemRole"}),ue=R({...ce,setup(_e){const{t:r}=W(),b=Y(),y=C(),T=te(()=>Q(()=>import("./drawer.a345a052.js"),["assets/drawer.a345a052.js","assets/vue.bd0669ce.js","assets/vue-i18n.cjs.2a00fe88.js","assets/_commonjsHelpers.35101cd5.js","assets/index.6abbbed7.js","assets/request.554ad02f.js","assets/storage.b628b270.js","assets/index.23ad033a.js","assets/index.aa7cec2e.js","assets/themeConfig.cb88f033.js","assets/index.f64fca3a.js","assets/index.e8f4f9cf.js","assets/index.ee56f1f7.js","assets/index.f9fbbdc9.js","assets/index.6b601b7a.js","assets/drawer.84cd71a2.css"])),w=C(),A=v({list:[]}),d=v({form:{name:""},rules:{topic:{required:!1,message:r("message.app.validateName"),pattern:/^[0-9a-zA-Z_.-]*$/,trigger:"blur"}}}),o=v({tableData:{data:[],total:0,loading:!1,param:{pageNum:1,pageSize:20}}}),p=async()=>{o.tableData.loading=!0;let t=await b.getList({name:d.form.name,page:o.tableData.param.pageNum,size:o.tableData.param.pageSize});o.tableData.data=[],t.list.forEach(function(e){o.tableData.data.push({id:e.id,name:e.name,namespaceAppIds:e.namespaceAppIds,events:e.events,metrics:e.metrics,locale:e.locale,method:e.method,url:e.url,secret:e.secret,status:e.status==1,createTime:z(e.createTime),updateTime:z(e.updateTime)})}),o.tableData.total=t.total,setTimeout(()=>{o.tableData.loading=!1},500)},k=t=>{!t||t.validate(e=>{if(e)p();else return!1})},$=()=>{d.form.name="",p()},x=t=>{w.value.openDrawer(t,1,null)},V=(t,e)=>{w.value.openDrawer(t,e)},N=t=>{ee.confirm(r("message.delay.job.deleteTitle")+`(${t.name})?`,r("message.commonMsg.tip"),{confirmButtonText:r("message.commonBtn.confirm"),cancelButtonText:r("message.commonBtn.cancel"),type:"warning"}).then(async()=>{await b.delete({id:t.id}),await p(),ae.success(r("message.commonMsg.deleteSuccess"))}).catch(()=>{})},E=t=>{o.tableData.param.pageSize=t,p()},M=t=>{o.tableData.param.pageNum=t,p()},I=async(t,e)=>{const h=t?1:2;await b.updateStatus({id:e.id,status:h})};return le(async()=>{A.list=await X(),await p()}),(t,e)=>{const h=n("el-input"),U=n("el-form-item"),D=n("el-col"),j=n("ele-Search"),c=n("el-icon"),u=n("el-button"),L=n("ele-RefreshRight"),O=n("ele-FolderAdd"),q=n("el-row"),F=n("el-form"),i=n("el-table-column"),H=n("el-switch"),P=n("ele-Edit"),J=n("ele-Delete"),K=n("el-table"),Z=n("el-pagination"),G=oe("loading");return S(),se("div",ie,[B("div",pe,[B("div",de,[a(F,{ref_key:"tableSearchRef",ref:y,model:d.form,rules:d.rules},{default:l(()=>[a(q,null,{default:l(()=>[a(D,{xs:8,sm:12,md:8,lg:6,xl:4,class:"mb20"},{default:l(()=>[a(U,{label:m(r)("message.alert.name"),prop:"name"},{default:l(()=>[a(h,{modelValue:d.form.name,"onUpdate:modelValue":e[0]||(e[0]=s=>d.form.name=s),size:"default",style:{width:"95%"}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),a(D,{xs:8,sm:12,md:8,lg:6,xl:4,class:"mb20"},{default:l(()=>[a(u,{size:"default",type:"primary",class:"ml10",onClick:e[1]||(e[1]=s=>k(y.value))},{default:l(()=>[a(c,null,{default:l(()=>[a(j)]),_:1}),f(" "+g(t.$t("message.commonBtn.query")),1)]),_:1}),a(u,{size:"default",type:"primary",class:"ml10",onClick:e[2]||(e[2]=s=>$())},{default:l(()=>[a(c,null,{default:l(()=>[a(L)]),_:1}),f(" "+g(t.$t("message.commonBtn.reset")),1)]),_:1}),a(u,{size:"default",type:"success",class:"ml10",onClick:e[3]||(e[3]=s=>x("add"))},{default:l(()=>[a(c,null,{default:l(()=>[a(O)]),_:1}),f(" "+g(t.$t("message.commonBtn.add")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),ne((S(),re(K,{data:o.tableData.data,style:{width:"100%"}},{default:l(()=>[a(i,{prop:"name",label:m(r)("message.alert.name"),"show-overflow-tooltip":""},null,8,["label"]),a(i,{prop:"locale",width:"120",label:m(r)("message.alert.locale"),"show-overflow-tooltip":""},null,8,["label"]),a(i,{prop:"method",width:"120",label:m(r)("message.alert.method"),"show-overflow-tooltip":""},null,8,["label"]),a(i,{prop:"url",label:m(r)("message.alert.url"),"show-overflow-tooltip":""},null,8,["label"]),a(i,{prop:"status",width:"120",label:m(r)("message.alert.status"),"show-overflow-tooltip":""},{default:l(s=>[a(H,{modelValue:s.row.status,"onUpdate:modelValue":_=>s.row.status=_,class:"ml-2",size:"default",onChange:_=>I(_,s.row),style:{"--el-switch-on-color":"#13ce66","--el-switch-off-color":"#ff4949"}},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1},8,["label"]),a(i,{prop:"createTime",label:m(r)("message.alert.createTime"),width:"200","show-overflow-tooltip":""},null,8,["label"]),a(i,{prop:"updateTime",label:m(r)("message.alert.updateTime"),width:"200","show-overflow-tooltip":""},null,8,["label"]),a(i,{label:m(r)("message.commonMsg.operation"),width:"300"},{default:l(s=>[a(u,{type:"primary",size:"default",onClick:_=>V("update",s.row)},{default:l(()=>[a(c,null,{default:l(()=>[a(P)]),_:1}),f(" "+g(t.$t("message.commonBtn.update")),1)]),_:2},1032,["onClick"]),a(u,{type:"danger",size:"default",onClick:_=>N(s.row)},{default:l(()=>[a(c,null,{default:l(()=>[a(J)]),_:1}),f(" "+g(t.$t("message.commonBtn.delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[G,o.tableData.loading]]),a(Z,{onSizeChange:E,onCurrentChange:M,class:"mt15","pager-count":5,"page-sizes":[10,20,30],"current-page":o.tableData.param.pageNum,"onUpdate:current-page":e[4]||(e[4]=s=>o.tableData.param.pageNum=s),background:"","page-size":o.tableData.param.pageSize,"onUpdate:page-size":e[5]||(e[5]=s=>o.tableData.param.pageSize=s),layout:"total, sizes, prev, pager, next, jumper",total:o.tableData.total},null,8,["current-page","page-size","total"])]),a(m(T),{ref_key:"AlertDrawerRef",ref:w,onRefresh:e[6]||(e[6]=s=>p())},null,512)])}}});const Ve=me(ue,[["__scopeId","data-v-a2de43ab"]]);export{Ve as default};
