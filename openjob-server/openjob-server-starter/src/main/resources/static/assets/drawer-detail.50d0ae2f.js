import{_ as A}from"./preload-helper.101896b7.js";import{h as S,ap as L,K as h,a9 as r,j as V,v as D,x as a,D as s,u as d,B as p,C as u,l as w,y as C,E as j}from"./vue.bd0669ce.js";import{u as E}from"./vue-i18n.cjs.2a00fe88.js";import{u as B}from"./index.85cc70c8.js";import"./_commonjsHelpers.35101cd5.js";import"./request.c46845dc.js";import"./storage.b628b270.js";import"./index.d2f052aa.js";import"./index.aa7cec2e.js";import"./themeConfig.cb88f033.js";import"./index.f64fca3a.js";import"./index.e8f4f9cf.js";import"./index.ee56f1f7.js";const z={class:"system-role-dialog-container",style:{padding:"10px",height:"100%"}},N={style:{"text-align":"center",height:"30px"}},P=S({name:"jobDrawerName"}),Y=S({...P,setup(M,{expose:v}){const T=L(()=>A(()=>import("./monaco.6d4f7d9c.js").then(t=>t.a),["assets/monaco.6d4f7d9c.js","assets/preload-helper.101896b7.js","assets/vue.bd0669ce.js","assets/monaco.82344604.css"])),{t:c}=E(),b=B(),e=h({loadingShow:!1,closeStatus:!1,editor:{editorStyle:"width: 100%;height: 100%;",language:"shell",value:""},drawer:{isShow:!1},descriptions:{column:6,workerAddress:"",createTime:"",completeTime:"",statusTag:"",statusLabel:"Default"}}),i=h({timerId:0,time:0,counter:0}),y=async t=>{e.descriptions.workerAddress=t.workerAddress,e.descriptions.createTime=t.createTime,e.descriptions.completeTime=t.completeTime,e.descriptions.statusTag=t.statusTag,e.descriptions.statusLabel=t.statusLabel,e.drawer.isShow=!0,e.editor.value="",i.time=0,e.closeStatus=!1,e.loadingShow=!1,await g(t,2)},g=async(t,l)=>{if(e.closeStatus)return;let n=200,o=await b.getTaskLog({taskId:t.taskId,status:t.status,time:i.time,loading:l,size:n}),m="";if(o.list.forEach(function(_){m+=_+`
`}),e.editor.value+=m,e.loadingShow=!1,o.time>0&&(i.time=o.time),o.complete!=1){if(o.list.length>0){e.loadingShow=!0,await g(t,2);return}e.loadingShow=!0,i.timerId=setInterval(async()=>{clearInterval(i.timerId),await g(t,1)},1e3)}},x=()=>{e.closeStatus=!0,clearInterval(i.timerId)};return v({openDrawer:y}),(t,l)=>{const n=r("el-descriptions-item"),o=r("el-tag"),m=r("el-descriptions"),_=r("Loading"),k=r("el-icon"),I=r("el-drawer");return V(),D(I,{modelValue:e.drawer.isShow,"onUpdate:modelValue":l[0]||(l[0]=f=>e.drawer.isShow=f),direction:"rtl",size:"60%",onClose:l[1]||(l[1]=f=>x())},{header:a(()=>[s(m,{style:{"margin-top":"10px"},column:e.descriptions.column},{default:a(()=>[s(n,{label:d(c)("message.job.instance.workerAddress"),width:"260px",align:"left"},{default:a(()=>[p(u(e.descriptions.workerAddress),1)]),_:1},8,["label"]),s(n,{label:d(c)("message.job.instance.createTime"),width:"260px",align:"left"},{default:a(()=>[p(u(e.descriptions.createTime),1)]),_:1},8,["label"]),s(n,{label:d(c)("message.job.instance.completeTime"),width:"260px",align:"left"},{default:a(()=>[p(u(e.descriptions.completeTime),1)]),_:1},8,["label"]),s(n,{label:d(c)("message.job.instance.status"),width:"260px",align:"left"},{default:a(()=>[s(o,{class:"ml-2",type:e.descriptions.statusTag,size:"small"},{default:a(()=>[p(u(e.descriptions.statusLabel),1)]),_:1},8,["type"])]),_:1},8,["label"])]),_:1},8,["column"])]),default:a(()=>[w("div",z,[s(d(T),{ref:"JobParamsMonacoEditor",editorStyle:e.editor.editorStyle,language:e.editor.language,value:e.editor.value,readOnly:!0,scrollBottom:!0,syncValue:!0},null,8,["editorStyle","language","value"])])]),footer:a(()=>[w("div",N,[C(s(k,{class:"is-loading",size:"30px"},{default:a(()=>[s(_)]),_:1},512),[[j,e.loadingShow]])])]),_:1},8,["modelValue"])}}});export{Y as default};
