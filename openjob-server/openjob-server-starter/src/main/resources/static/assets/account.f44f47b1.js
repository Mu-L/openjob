import{h as S,ar as R,aq as T,aH as U,K as q,a9 as i,ac as M,j as f,v as g,x as t,D as s,l as x,n as $,y as C,B as A,C as V}from"./vue.bd0669ce.js";import{u as D}from"./vue-i18n.cjs.2a00fe88.js";import{u as E}from"./themeConfig.cb88f033.js";import{i as J,b as L}from"./index.23f37e21.js";import{S as j}from"./storage.b628b270.js";import{N as z}from"./loading.3e617409.js";import{u as K}from"./index.32164f71.js";import{u as O}from"./userInfo.f7c9dd73.js";import{J as G}from"./index.f64fca3a.js";import{ay as P}from"./index.e8f4f9cf.js";import{_ as H}from"./_plugin-vue_export-helper.c27b6911.js";import"./_commonjsHelpers.35101cd5.js";import"./index.aa7cec2e.js";import"./keepAliveNames.f05bad75.js";import"./routesList.32d6bb58.js";import"./preload-helper.101896b7.js";import"./tagsViewRoutes.054c4a6f.js";import"./request.554ad02f.js";import"./index.23ad033a.js";import"./index.ee56f1f7.js";const Q=S({name:"loginAccount"}),W=S({...Q,setup(X){const I=K(),{t:p}=D(),b=E(),{themeConfig:F}=R(b),u=T(),w=U(),o=q({isShowPassword:!1,randomCode:((n=4)=>{let e="0123456789";function c(l,d){return Math.round(Math.random()*(d-l)+l)}let a="";for(var r=0;r<n;r++)a+=e[c(0,e.length-1)];return a})(),ruleForm:{username:"",password:"",keeplive:!0,code:""},loading:{signIn:!1}}),N=async()=>{if(o.randomCode!=o.ruleForm.code){await G.alert(p("message.codeMsg.c105"),p("message.commonMsg.tip"),{type:"warning"});return}o.loading.signIn=!0;let n=o.ruleForm;try{const e=await I.login(n);console.log(e),O().saveToSession(e.username,e.sessionKey,{userName:e.username,photo:"https://img2.baidu.com/it/u=1978192862,2048448374&fm=253&fmt=auto&app=138&f=JPEG?w=504&h=500",time:1800,roles:[],isAdmin:e.supperAdmin,authBtnList:[],perms:e.permNames})}catch(e){console.log(e),o.loading.signIn=!1;return}if(console.log("登录后 - 加载菜单路由列表"),F.value.isRequestRoutes){const e=await L();console.log("加载菜单路由列表",e),h(e)}else{const e=await J();h(e)}},h=n=>{var e,c,a,r;if(n)P.warning("抱歉，您没有登录权限"),j.clear();else{(e=u.query)!=null&&e.redirect?w.push({path:(c=u.query)==null?void 0:c.redirect,query:Object.keys((a=u.query)==null?void 0:a.params).length>0?JSON.parse((r=u.query)==null?void 0:r.params):""}):w.push("/dashboard");const l=p("message.signInText");P.success(`${l}`),z.start()}o.loading.signIn=!1};return(n,e)=>{const c=i("ele-User"),a=i("el-icon"),r=i("el-input"),l=i("el-form-item"),d=i("ele-Unlock"),k=i("ele-Position"),_=i("el-col"),y=i("el-button"),B=i("el-form"),v=M("waves");return f(),g(B,{size:"large",class:"login-content-form"},{default:t(()=>[s(l,{class:"login-animation1"},{default:t(()=>[s(r,{text:"",placeholder:n.$t("message.account.accountPlaceholder1"),modelValue:o.ruleForm.username,"onUpdate:modelValue":e[0]||(e[0]=m=>o.ruleForm.username=m),clearable:"",autocomplete:"off"},{prefix:t(()=>[s(a,{class:"el-input__icon"},{default:t(()=>[s(c)]),_:1})]),_:1},8,["placeholder","modelValue"])]),_:1}),s(l,{class:"login-animation2"},{default:t(()=>[s(r,{type:o.isShowPassword?"text":"password",placeholder:n.$t("message.account.accountPlaceholder2"),modelValue:o.ruleForm.password,"onUpdate:modelValue":e[2]||(e[2]=m=>o.ruleForm.password=m),autocomplete:"off"},{prefix:t(()=>[s(a,{class:"el-input__icon"},{default:t(()=>[s(d)]),_:1})]),suffix:t(()=>[x("i",{class:$(["iconfont el-input__icon login-content-password",o.isShowPassword?"icon-yincangmima":"icon-xianshimima"]),onClick:e[1]||(e[1]=m=>o.isShowPassword=!o.isShowPassword)},null,2)]),_:1},8,["type","placeholder","modelValue"])]),_:1}),s(l,{class:"login-animation3"},{default:t(()=>[s(_,{span:15},{default:t(()=>[s(r,{text:"",maxlength:"4",placeholder:n.$t("message.account.accountPlaceholder3"),modelValue:o.ruleForm.code,"onUpdate:modelValue":e[3]||(e[3]=m=>o.ruleForm.code=m),clearable:"",autocomplete:"off"},{prefix:t(()=>[s(a,{class:"el-input__icon"},{default:t(()=>[s(k)]),_:1})]),_:1},8,["placeholder","modelValue"])]),_:1}),s(_,{span:1}),s(_,{span:8},{default:t(()=>[C((f(),g(y,{class:"login-content-code"},{default:t(()=>[A(V(o.randomCode),1)]),_:1})),[[v]])]),_:1})]),_:1}),s(l,{class:"login-animation4"},{default:t(()=>[C((f(),g(y,{type:"primary",class:"login-content-submit",round:"",onClick:N,loading:o.loading.signIn},{default:t(()=>[x("span",null,V(n.$t("message.account.accountBtnText")),1)]),_:1},8,["loading"])),[[v]])]),_:1})]),_:1})}}});const ye=H(W,[["__scopeId","data-v-302c6e5b"]]);export{ye as default};
